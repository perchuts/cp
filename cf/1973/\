#include <bits/stdc++.h>
#define all(x) x.begin(), x.end()
#define sz(x) (int) x.size()
#define pb push_back
#define _ ios_base::sync_with_stdio(false);cin.tie(NULL);cout.tie(NULL);
#define int ll

using namespace std;

using ll = long long;
using ull = unsigned long long;
using ii = pair<int,int>;
using iii = tuple<int,int,int>;

const int inf = 2e9+1;
const int mod = 1e9+7;
const int maxn = 3e5+100;

template<typename X, typename Y> bool ckmin(X& x, const Y& y) { return (y < x) ? (x=y,1):0; }
template<typename X, typename Y> bool ckmax(X& x, const Y& y) { return (x < y) ? (x=y,1):0; }

void solve(){
 	int n, q; cin >> n >> q;
	vector<int> a(n), b(n), c(n);
	for (auto& x : a) cin >> x;
	for (auto& x : b) cin >> x;
	for (auto& x : c) cin >> x;
	int base_cost = 0;
	vector<ii> dps;	
	for (int __ = 0; __ < 2; ++__) {
		vector<int> fa, fb;
		for (int ____ = 0; ____ < 2; ++____) {
			for (int j = 1; j * j <= a[0]; ++j) {
				if (a[0] % j) continue;
				fa.pb(a[0] / j);
				if (j * j != a[0]) fa.pb(j);
			}
			swap(a[0], b[0]), swap(fa, fb);
		}
		sort(all(fa)), sort(all(fb));
		int s1 = sz(fa), s2 = sz(fb);
		vector<vector<ii>> freq(s1, vector<ii>(s2, make_pair(0, 0)));
		auto getId = [&] (int x, bool type) {
			if (type) return lower_bound(all(fa), x) - begin(fa);
			return lower_bound(all(fb), x) - begin(fb);
		};
		cout << "origin: ";
		cout << a[0] << ' ' << b[0] << ' ' << c[0] << endl;
		for (int i = 1; i < n; ++i) {
			// good way first	
			cout << a[i] << ' ' << b[i] << ' ' << c[i] << endl;
			int na = gcd(a[0], a[i]), nb = gcd(b[0], b[i]);
			int id_a = getId(na, 0), id_b = getId(nb, 1);
			cout << id_a << ' ' << id_b << endl;
			freq[id_a][id_b].second++;
			id_a = getId(gcd(a[0], b[i]), 0), id_b = getId(gcd(b[0], a[i]), 1);
			cout << id_a << ' ' << id_b << endl;
			freq[id_a][id_b].second++;
			freq[id_a][id_b].first += c[i];
			int g1 = gcd(gcd(a[0], a[i]), b[i]), g2 = gcd(gcd(b[0], a[i]), b[i]);
			id_a = getId(g1, 0), id_b = getId(g2, 1);
			cout << id_a << ' ' << id_b << endl;
			freq[id_a][id_b].first -= c[i];
			freq[id_a][id_b].second--;
		}
		cout << endl;
		cout << "divs do a:" << endl;
		for (auto x : fa) cout << x << ' ';
		cout << endl;
		cout << "divs do b:" << endl;
		for (auto x : fb) cout << x << ' ';
		cout << endl;
		cout << "freqs (soh frequencia msm):" << endl;
		for (auto& x : freq) { for (auto& y : x) cout << y.second << ' '; cout << endl; }
		cout << "freqs (soh custo):" << endl;
		for (auto& x : freq) { for (auto& y : x) cout << y.first << ' '; cout << endl; }
		auto dp = freq;
		for (int i = s1-1; i >= 0; --i) {
			for (int j = s2-1; j >= 0; --j) {
				for (int k = i + 1; k < s1; ++k) {
					if (fa[k] % fa[i]) continue;
					dp[i][j].first += dp[k][j].first;
					dp[i][j].second += dp[k][j].second;
				}
			}
		}
		cout << "dp (soh freq msm):" << endl;
		for (auto& x : dp) { for (auto& y : x) cout << y.second << ' '; cout << endl; }
		cout << "dp (soh custo):" << endl;
		for (auto& x : dp) { for (auto& y : x) cout << y.first << ' '; cout << endl; }
		auto dp2 = dp;
		for (int i = s1-1; i >= 0; --i) {
			for (int j = s2-1; j >= 0; --j) {
				for (int k = j + 1; k < s2; ++k) {
					if (fb[k] % fb[i]) continue;
					dp2[i][j].first += dp[i][k].first;
					dp2[i][j].second += dp[i][k].second;
				}
				if (dp2[i][j].second == n-1) {
					dps.emplace_back(base_cost + dp2[i][j].first, fa[i] + fb[j]);
				}
			}	
		}
		cout << "dp2 (soh freq msm):" << endl;
		for (auto& x : dp2) { for (auto& y : x) cout << y.second << ' '; cout << endl; }
		cout << "dp2 (soh custo):" << endl;
		for (auto& x : dp2) { for (auto& y : x) cout << y.first << ' '; cout << endl; }
		swap(a[0], b[0]);
		base_cost += c[0];
	}
	sort(all(dps));
	vector<ii> ndp;
	for (auto [x, y] : dps) {
		while (!ndp.empty() && ndp.back().second <= y) ndp.pop_back();
		ndp.pb({x, y});
	}
	cout << "DPS:" << endl;
	swap(ndp, dps);
	for (auto x : dps) cout << x.first << ' ' << x.second << endl;
	cout.flush();
	while (q--) {
		int cost; cin >> cost;
		int ans = lower_bound(all(dps), make_pair(cost+1, 0ll)) - begin(dps) - 1;
		cout << dps[ans].second << ' ';
	}
	cout << endl;

}

int32_t main(){_
  int t = 1; //cin >> t;
  while(t--) solve();
}
